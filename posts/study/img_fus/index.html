<!DOCTYPE html>
<html lang="cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>可见光与红外图像融合指标批量计算 | 染竹君的个人博客</title>
<meta name="keywords" content="图像融合">
<meta name="description" content="可见光与红外图像融合 写了一个批量计算图像融合指标的脚本，主要用到了scikit-image模块，点击可查看官方文档
安装scikit-image 建议建立一个虚拟Python环境运行，虚拟环境的意义，就如同虚拟机一样，它可以实现不同环境中Python依赖包相互独立，互不干扰。
创建虚拟环境的步骤：
  第一步：安装Virtualenv
1  pip3 install virtualenv -i https://pypi.python.org/simple/     第二步：cd 到存放虚拟环境的目录地址，执行以下代码创建虚拟环境
1 2 3 4  virtualenv python3_env # 你也可以指定版本 virtualenv -p /usr/bin/python2.7 python2_env virtualenv -p /usr/bin/python3.8 python3_env     第三步：激活虚拟环境
ubuntu执行以下命令：
1  source python3_env/bin/activate   Windows执行以下命令：
1  .\Scripts\activate.bat     第四步：退出虚拟环境
ubuntu执行：
1  deactivate   Windows执行：
1  .\Scripts\deactivate.bat     接下来进入正文，安装scikit-image，激活虚拟环境后，pip安装">
<meta name="author" content="染竹君">
<link rel="canonical" href="https://dyedbamboo.github.io/posts/study/img_fus/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.4b7d810bc0c98044b1c7a72962d55d7f125a07c3ed5cf31e670c3fdecc98b341.css" integrity="sha256-S32BC8DJgESxx6cpYtVdfxJaB8PtXPMeZww/3syYs0E=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://dyedbamboo.github.io/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://dyedbamboo.github.io/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://dyedbamboo.github.io/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://dyedbamboo.github.io/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="https://dyedbamboo.github.io/favicon/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<meta name="baidu-site-verification" content="code-9oLyeix0aK" />
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4a41bf85d719f0e8c3165fc76904f546";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-C6GDZ56F4S"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-C6GDZ56F4S', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="可见光与红外图像融合指标批量计算" />
<meta property="og:description" content="可见光与红外图像融合 写了一个批量计算图像融合指标的脚本，主要用到了scikit-image模块，点击可查看官方文档
安装scikit-image 建议建立一个虚拟Python环境运行，虚拟环境的意义，就如同虚拟机一样，它可以实现不同环境中Python依赖包相互独立，互不干扰。
创建虚拟环境的步骤：
  第一步：安装Virtualenv
1  pip3 install virtualenv -i https://pypi.python.org/simple/     第二步：cd 到存放虚拟环境的目录地址，执行以下代码创建虚拟环境
1 2 3 4  virtualenv python3_env # 你也可以指定版本 virtualenv -p /usr/bin/python2.7 python2_env virtualenv -p /usr/bin/python3.8 python3_env     第三步：激活虚拟环境
ubuntu执行以下命令：
1  source python3_env/bin/activate   Windows执行以下命令：
1  .\Scripts\activate.bat     第四步：退出虚拟环境
ubuntu执行：
1  deactivate   Windows执行：
1  .\Scripts\deactivate.bat     接下来进入正文，安装scikit-image，激活虚拟环境后，pip安装" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dyedbamboo.github.io/posts/study/img_fus/" /><meta property="og:image" content="https://i.loli.net/2021/09/26/3OMGXylm8HUYJ6p.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-07T20:15:50&#43;08:00" />
<meta property="article:modified_time" content="2022-06-07T20:15:50&#43;08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://i.loli.net/2021/09/26/3OMGXylm8HUYJ6p.png"/>

<meta name="twitter:title" content="可见光与红外图像融合指标批量计算"/>
<meta name="twitter:description" content="可见光与红外图像融合 写了一个批量计算图像融合指标的脚本，主要用到了scikit-image模块，点击可查看官方文档
安装scikit-image 建议建立一个虚拟Python环境运行，虚拟环境的意义，就如同虚拟机一样，它可以实现不同环境中Python依赖包相互独立，互不干扰。
创建虚拟环境的步骤：
  第一步：安装Virtualenv
1  pip3 install virtualenv -i https://pypi.python.org/simple/     第二步：cd 到存放虚拟环境的目录地址，执行以下代码创建虚拟环境
1 2 3 4  virtualenv python3_env # 你也可以指定版本 virtualenv -p /usr/bin/python2.7 python2_env virtualenv -p /usr/bin/python3.8 python3_env     第三步：激活虚拟环境
ubuntu执行以下命令：
1  source python3_env/bin/activate   Windows执行以下命令：
1  .\Scripts\activate.bat     第四步：退出虚拟环境
ubuntu执行：
1  deactivate   Windows执行：
1  .\Scripts\deactivate.bat     接下来进入正文，安装scikit-image，激活虚拟环境后，pip安装"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://dyedbamboo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "可见光与红外图像融合指标批量计算",
      "item": "https://dyedbamboo.github.io/posts/study/img_fus/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "可见光与红外图像融合指标批量计算",
  "name": "可见光与红外图像融合指标批量计算",
  "description": "可见光与红外图像融合 写了一个批量计算图像融合指标的脚本，主要用到了scikit-image模块，点击可查看官方文档\n安装scikit-image 建议建立一个虚拟Python环境运行，虚拟环境的意义，就如同虚拟机一样，它可以实现不同环境中Python依赖包相互独立，互不干扰。\n创建虚拟环境的步骤：\n  第一步：安装Virtualenv\n1  pip3 install virtualenv -i https://pypi.python.org/simple/     第二步：cd 到存放虚拟环境的目录地址，执行以下代码创建虚拟环境\n1 2 3 4  virtualenv python3_env # 你也可以指定版本 virtualenv -p /usr/bin/python2.7 python2_env virtualenv -p /usr/bin/python3.8 python3_env     第三步：激活虚拟环境\nubuntu执行以下命令：\n1  source python3_env/bin/activate   Windows执行以下命令：\n1  .\\Scripts\\activate.bat     第四步：退出虚拟环境\nubuntu执行：\n1  deactivate   Windows执行：\n1  .\\Scripts\\deactivate.bat     接下来进入正文，安装scikit-image，激活虚拟环境后，pip安装",
  "keywords": [
    "图像融合"
  ],
  "articleBody": "可见光与红外图像融合 写了一个批量计算图像融合指标的脚本，主要用到了scikit-image模块，点击可查看官方文档\n安装scikit-image 建议建立一个虚拟Python环境运行，虚拟环境的意义，就如同虚拟机一样，它可以实现不同环境中Python依赖包相互独立，互不干扰。\n创建虚拟环境的步骤：\n  第一步：安装Virtualenv\n1  pip3 install virtualenv -i https://pypi.python.org/simple/     第二步：cd 到存放虚拟环境的目录地址，执行以下代码创建虚拟环境\n1 2 3 4  virtualenv python3_env # 你也可以指定版本 virtualenv -p /usr/bin/python2.7 python2_env virtualenv -p /usr/bin/python3.8 python3_env     第三步：激活虚拟环境\nubuntu执行以下命令：\n1  source python3_env/bin/activate   Windows执行以下命令：\n1  .\\Scripts\\activate.bat     第四步：退出虚拟环境\nubuntu执行：\n1  deactivate   Windows执行：\n1  .\\Scripts\\deactivate.bat     接下来进入正文，安装scikit-image，激活虚拟环境后，pip安装\n1 2 3 4  # 更新pip python -m pip install -U pip # 安装 scikit-image python -m pip install -U scikit-image   批量计算图像融合指标SSIM、RMSE、PSNR、EN、AG 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113  import cv2 import math import os import numpy as np import matplotlib.pyplot as plt from skimage.metrics import mean_squared_error as compare_mse from skimage.metrics import peak_signal_noise_ratio as compare_psnr from skimage.metrics import structural_similarity as compare_ssim from skimage.measure import shannon_entropy as compare_entropy def compare_img(img_raw_path, img_fusion_path): ssim_list = [] rmse_list = [] psnr_list = [] en_list = [] ag_list = [] for filename_raw ,filename_fusion in zip(os.listdir(img_raw_path),os.listdir(img_fusion_path)): img_raw = cv2.imread(img_raw_path+'/'+filename_raw) img_fusion = cv2.imread(img_fusion_path+'/'+filename_fusion) ssim = compare_ssim(img_raw, img_fusion, channel_axis=2) # 对于多通道图像(RGB、HSV等)关键词multichannel要设置为True rmse = math.sqrt(compare_mse(img_raw, img_fusion)) psnr = compare_psnr(img_raw, img_fusion) en = compare_entropy(img_fusion) ag = compare_ag(img_fusion) ssim_list.append(ssim) rmse_list.append(rmse) psnr_list.append(psnr) en_list.append(en) ag_list.append(ag) return ssim_list, rmse_list, psnr_list,en_list,ag_list def compare_ag(image): image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY) image = np.array(image) image = image.astype(np.float32) width = image.shape[1] width = width - 1 height = image.shape[0] height = height - 1 tmp = 0 for i in range(1,height): for j in range(1,width): dx = image[i][j + 1] - image[i][j] dy = image[i + 1][j] - image[i][j] ds = math.sqrt((dx * dx + dy * dy) / 2) tmp += ds return tmp / (height * width) def cal_mean_metric(list1,list2): average_metric = [list1,list2] average_metric = list(np.mean(average_metric, axis=0)) return average_metric def plot_metric(list1,list2,name): plt.figure() img_nums = len(list1) x_axis_data = range(1, img_nums+1) plt.plot(x_axis_data, list1, 'b*--',label=\"Original method \"+name ,linewidth=1) plt.plot(x_axis_data, list2, 'r.--',label=\"Improved method \"+name,linewidth=1) plt.legend() plt.xticks(x_axis_data) plt.xlabel(\"Image pair\", fontsize=13, fontweight='bold') plt.ylabel(\"Metrics Value\", fontsize=13, fontweight='bold') if __name__ == \"__main__\": img_rgb_path = './img/rgb' img_red_path = './img/red' img_fusion_path = './img/img_fusion/' img_improve_path = './img/img_improve_fusion' rgb_ssim_list,rgb_rmse_list,rgb_psnr_list,rgb_en_list,rgb_ag_list = compare_img(img_rgb_path, img_fusion_path) red_ssim_list,red_rmse_list,red_psnr_list,red_en_list,red_ag_list = compare_img(img_red_path, img_fusion_path) average_ssim = cal_mean_metric(rgb_ssim_list,red_ssim_list) average_rmse = cal_mean_metric(rgb_rmse_list,red_rmse_list) average_psnr = cal_mean_metric(rgb_psnr_list,red_psnr_list) # for i in range(len(average_ssim)): # print(\"改进前:Average SSIM: %.4f\" %average_ssim[i], # \"Average RMSE: %.4f\" %average_rmse[i], # \"Average PSNR: %.4f\" %average_psnr[i], # \"EN: %.4f\" %rgb_en_list[i], # \"AG: %.4f\" %rgb_ag_list[i]) print(\"改进前:Average SSIM: %.4f\" %np.mean(rgb_ssim_list), \"Average RMSE: %.4f\" %np.mean(rgb_rmse_list), \"Average PSNR: %.4f\" %np.mean(rgb_psnr_list), \"EN: %.4f\" %np.mean(rgb_en_list), \"AG: %.4f\" %np.mean(rgb_ag_list)) rgb_ssim_list1,rgb_rmse_list1,rgb_psnr_list1,rgb_en_list1,rgb_ag_list1 = compare_img(img_rgb_path, img_improve_path) red_ssim_list1,red_rmse_list1,red_psnr_list1,red_en_list1,red_ag_list1 = compare_img(img_red_path, img_improve_path) average_ssim1 = cal_mean_metric(rgb_ssim_list1,red_ssim_list1) average_rmse1 = cal_mean_metric(rgb_rmse_list1,red_rmse_list1) average_psnr1 = cal_mean_metric(rgb_psnr_list1,red_psnr_list1) # for i in range(len(average_ssim1)): # print(\"改进后:Average SSIM: %.4f\" %average_ssim1[i], # \"Average RMSE: %.4f\" %average_rmse1[i], # \"Average PSNR: %.4f\" %average_psnr1[i], # \"EN: %.4f\" %rgb_en_list1[i], # \"AG: %.4f\" %rgb_ag_list1[i]) print(\"改进后:Average SSIM: %.4f\" %np.mean(rgb_ssim_list1), \"Average RMSE: %.4f\" %np.mean(rgb_rmse_list1), \"Average PSNR: %.4f\" %np.mean(rgb_psnr_list1), \"EN: %.4f\" %np.mean(rgb_en_list1), \"AG: %.4f\" %np.mean(rgb_ag_list1)) plot_metric(average_ssim,average_ssim1,\"SSIM\") plot_metric(average_rmse,average_rmse1,\"RMSE\") plot_metric(average_psnr,average_psnr1,\"PSNR\") plot_metric(rgb_en_list,rgb_en_list1,\"EN\") plot_metric(rgb_ag_list,rgb_ag_list1,\"AG\") plt.show()   运行结果如下\n\r\r\r\r\r\r\r\r\r\r\r\r",
  "wordCount" : "542",
  "inLanguage": "cn",
  "datePublished": "2022-06-07T20:15:50+08:00",
  "dateModified": "2022-06-07T20:15:50+08:00",
  "author":[{
    "@type": "Person",
    "name": "染竹君"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dyedbamboo.github.io/posts/study/img_fus/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "染竹君的个人博客",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dyedbamboo.github.io/favicon/favicon.ico"
    }
  }
}
</script>
</head>

<body class="">
    <a id="top"></a>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://dyedbamboo.github.io/" accesskey="h" title="染竹君的小站 (Alt + H)">
                        
                    <img src="https://dyedbamboo.github.io/img/logo_hue7837a3d2f79ccdd94da0537755daebc_15738_0x30_resize_box_3.png" alt="logo" aria-label="logo"
                        height="30">染竹君的小站</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://dyedbamboo.github.io/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://dyedbamboo.github.io/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://dyedbamboo.github.io/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://dyedbamboo.github.io/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://dyedbamboo.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://dyedbamboo.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      可见光与红外图像融合指标批量计算<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>
    </h1>
    <div class="post-meta"><span title='2022-06-07 20:15:50 +0800 CST'>June 7, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;染竹君
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%8f%af%e8%a7%81%e5%85%89%e4%b8%8e%e7%ba%a2%e5%a4%96%e5%9b%be%e5%83%8f%e8%9e%8d%e5%90%88" aria-label="可见光与红外图像融合">可见光与红外图像融合</a><ul>
                        
                <li>
                    <a href="#%e5%ae%89%e8%a3%85scikit-image" aria-label="安装scikit-image">安装scikit-image</a></li>
                <li>
                    <a href="#%e6%89%b9%e9%87%8f%e8%ae%a1%e7%ae%97%e5%9b%be%e5%83%8f%e8%9e%8d%e5%90%88%e6%8c%87%e6%a0%87ssimrmsepsnrenag" aria-label="批量计算图像融合指标SSIM、RMSE、PSNR、EN、AG">批量计算图像融合指标SSIM、RMSE、PSNR、EN、AG</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="可见光与红外图像融合">可见光与红外图像融合<a hidden class="anchor" aria-hidden="true" href="#可见光与红外图像融合">#</a></h1>
<p>写了一个批量计算图像融合指标的脚本，主要用到了<a href="https://scikit-image.org/">scikit-image模块</a>，点击可查看官方文档</p>
<h2 id="安装scikit-image">安装scikit-image<a hidden class="anchor" aria-hidden="true" href="#安装scikit-image">#</a></h2>
<p>建议建立一个虚拟Python环境运行，虚拟环境的意义，就如同虚拟机一样，它可以实现不同环境中Python依赖包相互独立，互不干扰。</p>
<p><strong>创建虚拟环境的步骤：</strong></p>
<ul>
<li>
<p>第一步：安装Virtualenv</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">virtualenv</span> <span class="o">-</span><span class="n">i</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">simple</span><span class="o">/</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第二步：cd 到存放虚拟环境的目录地址，执行以下代码创建虚拟环境</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">virtualenv</span> <span class="n">python3_env</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># 你也可以指定版本</span>
</span></span><span class="line"><span class="cl"><span class="n">virtualenv</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python2</span><span class="mf">.7</span> <span class="n">python2_env</span>
</span></span><span class="line"><span class="cl"><span class="n">virtualenv</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span> <span class="n">python3_env</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第三步：激活虚拟环境</p>
<p>ubuntu执行以下命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">source python3_env/bin/activate
</span></span></code></pre></td></tr></table>
</div>
</div><p>Windows执行以下命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.\Scripts\activate.bat
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第四步：退出虚拟环境</p>
<p>ubuntu执行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">deactivate
</span></span></code></pre></td></tr></table>
</div>
</div><p>Windows执行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.\Scripts\deactivate.bat
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>接下来进入正文，安装scikit-image，激活虚拟环境后，pip安装</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 更新pip</span>
</span></span><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">pip</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 安装 scikit-image</span>
</span></span><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">scikit</span><span class="o">-</span><span class="n">image</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="批量计算图像融合指标ssimrmsepsnrenag">批量计算图像融合指标SSIM、RMSE、PSNR、EN、AG<a hidden class="anchor" aria-hidden="true" href="#批量计算图像融合指标ssimrmsepsnrenag">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span> <span class="k">as</span> <span class="n">compare_mse</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.metrics</span> <span class="kn">import</span> <span class="n">peak_signal_noise_ratio</span> <span class="k">as</span> <span class="n">compare_psnr</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.metrics</span> <span class="kn">import</span> <span class="n">structural_similarity</span> <span class="k">as</span> <span class="n">compare_ssim</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">shannon_entropy</span> <span class="k">as</span> <span class="n">compare_entropy</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compare_img</span><span class="p">(</span><span class="n">img_raw_path</span><span class="p">,</span> <span class="n">img_fusion_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ssim_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">rmse_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">psnr_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">en_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">ag_list</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">filename_raw</span> <span class="p">,</span><span class="n">filename_fusion</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">img_raw_path</span><span class="p">),</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">img_fusion_path</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">img_raw</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_raw_path</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">filename_raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">img_fusion</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fusion_path</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">filename_fusion</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ssim</span> <span class="o">=</span> <span class="n">compare_ssim</span><span class="p">(</span><span class="n">img_raw</span><span class="p">,</span> <span class="n">img_fusion</span><span class="p">,</span> <span class="n">channel_axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 对于多通道图像(RGB、HSV等)关键词multichannel要设置为True</span>
</span></span><span class="line"><span class="cl">        <span class="n">rmse</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">compare_mse</span><span class="p">(</span><span class="n">img_raw</span><span class="p">,</span> <span class="n">img_fusion</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">psnr</span> <span class="o">=</span> <span class="n">compare_psnr</span><span class="p">(</span><span class="n">img_raw</span><span class="p">,</span> <span class="n">img_fusion</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">en</span> <span class="o">=</span> <span class="n">compare_entropy</span><span class="p">(</span><span class="n">img_fusion</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ag</span> <span class="o">=</span> <span class="n">compare_ag</span><span class="p">(</span><span class="n">img_fusion</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ssim_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssim</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rmse_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">psnr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psnr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">en_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ag_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ag</span><span class="p">)</span>        
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ssim_list</span><span class="p">,</span> <span class="n">rmse_list</span><span class="p">,</span> <span class="n">psnr_list</span><span class="p">,</span><span class="n">en_list</span><span class="p">,</span><span class="n">ag_list</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compare_ag</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">width</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">height</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">width</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">dx</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">image</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">dy</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">image</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ds</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">tmp</span> <span class="o">+=</span> <span class="n">ds</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">tmp</span> <span class="o">/</span> <span class="p">(</span><span class="n">height</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">cal_mean_metric</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">average_metric</span> <span class="o">=</span> <span class="p">[</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">average_metric</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">average_metric</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">average_metric</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">plot_metric</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_nums</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x_axis_data</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">img_nums</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis_data</span><span class="p">,</span> <span class="n">list1</span><span class="p">,</span> <span class="s1">&#39;b*--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;Original method &#34;</span><span class="o">+</span><span class="n">name</span> <span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis_data</span><span class="p">,</span> <span class="n">list2</span><span class="p">,</span> <span class="s1">&#39;r.--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;Improved method &#34;</span><span class="o">+</span><span class="n">name</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_axis_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&#34;Image pair&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Metrics Value&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_rgb_path</span> <span class="o">=</span> <span class="s1">&#39;./img/rgb&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_red_path</span> <span class="o">=</span> <span class="s1">&#39;./img/red&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_fusion_path</span> <span class="o">=</span> <span class="s1">&#39;./img/img_fusion/&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_improve_path</span> <span class="o">=</span> <span class="s1">&#39;./img/img_improve_fusion&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">rgb_ssim_list</span><span class="p">,</span><span class="n">rgb_rmse_list</span><span class="p">,</span><span class="n">rgb_psnr_list</span><span class="p">,</span><span class="n">rgb_en_list</span><span class="p">,</span><span class="n">rgb_ag_list</span> <span class="o">=</span> <span class="n">compare_img</span><span class="p">(</span><span class="n">img_rgb_path</span><span class="p">,</span> <span class="n">img_fusion_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">red_ssim_list</span><span class="p">,</span><span class="n">red_rmse_list</span><span class="p">,</span><span class="n">red_psnr_list</span><span class="p">,</span><span class="n">red_en_list</span><span class="p">,</span><span class="n">red_ag_list</span> <span class="o">=</span> <span class="n">compare_img</span><span class="p">(</span><span class="n">img_red_path</span><span class="p">,</span> <span class="n">img_fusion_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">average_ssim</span> <span class="o">=</span> <span class="n">cal_mean_metric</span><span class="p">(</span><span class="n">rgb_ssim_list</span><span class="p">,</span><span class="n">red_ssim_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">average_rmse</span> <span class="o">=</span> <span class="n">cal_mean_metric</span><span class="p">(</span><span class="n">rgb_rmse_list</span><span class="p">,</span><span class="n">red_rmse_list</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">average_psnr</span> <span class="o">=</span> <span class="n">cal_mean_metric</span><span class="p">(</span><span class="n">rgb_psnr_list</span><span class="p">,</span><span class="n">red_psnr_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># for i in range(len(average_ssim)):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;改进前:Average SSIM: %.4f&#34; %average_ssim[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;Average RMSE: %.4f&#34; %average_rmse[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;Average PSNR: %.4f&#34; %average_psnr[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;EN: %.4f&#34; %rgb_en_list[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;AG: %.4f&#34; %rgb_ag_list[i])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;改进前:Average SSIM: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_ssim_list</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Average RMSE: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_rmse_list</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Average PSNR: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_psnr_list</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;EN: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_en_list</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;AG: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_ag_list</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">rgb_ssim_list1</span><span class="p">,</span><span class="n">rgb_rmse_list1</span><span class="p">,</span><span class="n">rgb_psnr_list1</span><span class="p">,</span><span class="n">rgb_en_list1</span><span class="p">,</span><span class="n">rgb_ag_list1</span> <span class="o">=</span> <span class="n">compare_img</span><span class="p">(</span><span class="n">img_rgb_path</span><span class="p">,</span> <span class="n">img_improve_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">red_ssim_list1</span><span class="p">,</span><span class="n">red_rmse_list1</span><span class="p">,</span><span class="n">red_psnr_list1</span><span class="p">,</span><span class="n">red_en_list1</span><span class="p">,</span><span class="n">red_ag_list1</span> <span class="o">=</span> <span class="n">compare_img</span><span class="p">(</span><span class="n">img_red_path</span><span class="p">,</span> <span class="n">img_improve_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">average_ssim1</span> <span class="o">=</span> <span class="n">cal_mean_metric</span><span class="p">(</span><span class="n">rgb_ssim_list1</span><span class="p">,</span><span class="n">red_ssim_list1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">average_rmse1</span> <span class="o">=</span> <span class="n">cal_mean_metric</span><span class="p">(</span><span class="n">rgb_rmse_list1</span><span class="p">,</span><span class="n">red_rmse_list1</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">average_psnr1</span> <span class="o">=</span> <span class="n">cal_mean_metric</span><span class="p">(</span><span class="n">rgb_psnr_list1</span><span class="p">,</span><span class="n">red_psnr_list1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># for i in range(len(average_ssim1)):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;改进后:Average SSIM: %.4f&#34; %average_ssim1[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;Average RMSE: %.4f&#34; %average_rmse1[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;Average PSNR: %.4f&#34; %average_psnr1[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;EN: %.4f&#34; %rgb_en_list1[i],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#           &#34;AG: %.4f&#34; %rgb_ag_list1[i])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;改进后:Average SSIM: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_ssim_list1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Average RMSE: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_rmse_list1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Average PSNR: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_psnr_list1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;EN: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_en_list1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;AG: </span><span class="si">%.4f</span><span class="s2">&#34;</span> <span class="o">%</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rgb_ag_list1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">plot_metric</span><span class="p">(</span><span class="n">average_ssim</span><span class="p">,</span><span class="n">average_ssim1</span><span class="p">,</span><span class="s2">&#34;SSIM&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot_metric</span><span class="p">(</span><span class="n">average_rmse</span><span class="p">,</span><span class="n">average_rmse1</span><span class="p">,</span><span class="s2">&#34;RMSE&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot_metric</span><span class="p">(</span><span class="n">average_psnr</span><span class="p">,</span><span class="n">average_psnr1</span><span class="p">,</span><span class="s2">&#34;PSNR&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot_metric</span><span class="p">(</span><span class="n">rgb_en_list</span><span class="p">,</span><span class="n">rgb_en_list1</span><span class="p">,</span><span class="s2">&#34;EN&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plot_metric</span><span class="p">(</span><span class="n">rgb_ag_list</span><span class="p">,</span><span class="n">rgb_ag_list1</span><span class="p">,</span><span class="s2">&#34;AG&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行结果如下</p>
<p><figure><a class="lightgallery" href="Figure_1.png" title="Figure_1.png" data-thumbnail="Figure_1.png">
        <img
            class="lazy"
            src="/svg/loading.min.svg"
            data-src="Figure_1.png"
            loading="lazy"
            title="Figure_1.png"
            alt="Figure_1.png" />
    </a><figcaption class="image-caption"></figcaption>
</figure>
</p>
<p><figure><a class="lightgallery" href="Figure_2.png" title="Figure_2.png" data-thumbnail="Figure_2.png">
        <img
            class="lazy"
            src="/svg/loading.min.svg"
            data-src="Figure_2.png"
            loading="lazy"
            title="Figure_2.png"
            alt="Figure_2.png" />
    </a><figcaption class="image-caption"></figcaption>
</figure>
</p>
<p><figure><a class="lightgallery" href="Figure_3.png" title="Figure_3.png" data-thumbnail="Figure_3.png">
        <img
            class="lazy"
            src="/svg/loading.min.svg"
            data-src="Figure_3.png"
            loading="lazy"
            title="Figure_3.png"
            alt="Figure_3.png" />
    </a><figcaption class="image-caption"></figcaption>
</figure>
</p>
<p><figure><a class="lightgallery" href="Figure_4.png" title="Figure_4.png" data-thumbnail="Figure_4.png">
        <img
            class="lazy"
            src="/svg/loading.min.svg"
            data-src="Figure_4.png"
            loading="lazy"
            title="Figure_4.png"
            alt="Figure_4.png" />
    </a><figcaption class="image-caption"></figcaption>
</figure>
</p>
<p><figure><a class="lightgallery" href="Figure_5.png" title="Figure_5.png" data-thumbnail="Figure_5.png">
        <img
            class="lazy"
            src="/svg/loading.min.svg"
            data-src="Figure_5.png"
            loading="lazy"
            title="Figure_5.png"
            alt="Figure_5.png" />
    </a><figcaption class="image-caption"></figcaption>
</figure>
</p>
<p><figure><a class="lightgallery" href="%e6%8d%95%e8%8e%b7.JPG" title="捕获.JPG" data-thumbnail="捕获.JPG">
        <img
            class="lazy"
            src="/svg/loading.min.svg"
            data-src="%e6%8d%95%e8%8e%b7.JPG"
            loading="lazy"
            title="捕获.JPG"
            alt="捕获.JPG" />
    </a><figcaption class="image-caption"></figcaption>
</figure>
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://dyedbamboo.github.io/tags/%E5%9B%BE%E5%83%8F%E8%9E%8D%E5%90%88/">图像融合</a></li>
    </ul><div id="post-licensing" class="admonition warning">
    <div class="details-summary admonition-title">
        版权声明 <a rel="license" target="_blank" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i></a>
    </div>
    
    <div class="details-content">
        <div class="admonition-content">
            <ul>
                <li>本文作者：染竹君。</li>
                <li>本文链接：https://dyedbamboo.github.io/posts/study/img_fus/。</li>
                <li>许可说明：本站所有文章除特殊声明外，均使用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="license" target="_blank"><i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i> CC BY 4.0 </a> 许可协议，转载请注明出处。</li>
            </ul>
        </div>
    </div>
</div>
<nav class="paginav">
  <a class="next" href="https://dyedbamboo.github.io/posts/hugo/hugo/">
    <span class="title">Next Page <i class="fas fa-angle-double-right"></i></span>
    <br>
    <span>Hugo常用命令</span>
  </a>
</nav>

  </footer>
<footer class="tc-container" id="comment">
    <div class="tc-title"><p class="c-title">Discussion</p></div>
    <div id="tcomments"></div>
</footer>
<script crossorigin="anonymous" src="/js/twikoo.min.64322d6748f9b8b12dfb029616065f8eeed16467444adde58bab7d98c5733adf.js" integrity="sha256-ZDItZ0j5uLEt&#43;wKWFgZfju7RZGdESt3li6t9mMVzOt8="></script>
<script>
    twikoo.init({
        envId: 'https://twikoo-sigma.vercel.app/',
        el: '#tcomments',
        region: 'ap-chengdu', 
        
        lang: 'zh-CN', 
    });
</script>
</article>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script>
    class Accordion {
        constructor(el) {
            
            this.el = el;
            
            this.summary = el.querySelector('summary');
            
            this.content = el.querySelector('.inner');

            
            this.animation = null;
            
            this.isClosing = false;
            
            this.isExpanding = false;
            
            this.summary.addEventListener('click', (e) => this.onClick(e));
        }

        onClick(e) {
            
            e.preventDefault();
            
            this.el.style.overflow = 'hidden';
            
            if (this.isClosing || !this.el.open) {
            this.open();
            
            } else if (this.isExpanding || this.el.open) {
            this.shrink();
            }
        }

        shrink() {
            
            this.isClosing = true;
            
            
            const startHeight = `${this.el.offsetHeight}px`;
            
            const endHeight = `${this.summary.offsetHeight}px`;
            
            
            if (this.animation) {
            
            this.animation.cancel();
            }
            
            
            this.animation = this.el.animate({
            
            height: [startHeight, endHeight]
            }, {
            duration: 400,
            easing: 'ease-out'
            });
            
            
            this.animation.onfinish = () => this.onAnimationFinish(false);
            
            this.animation.oncancel = () => this.isClosing = false;
        }

        open() {
            
            this.el.style.height = `${this.el.offsetHeight}px`;
            
            this.el.open = true;
            
            window.requestAnimationFrame(() => this.expand());
        }

        expand() {
            
            this.isExpanding = true;
            
            const startHeight = `${this.el.offsetHeight}px`;
            
            const endHeight = `${this.summary.offsetHeight + this.content.offsetHeight}px`;
            
            
            if (this.animation) {
            
            this.animation.cancel();
            }
            
            
            this.animation = this.el.animate({
            
            height: [startHeight, endHeight]
            }, {
            duration: 400,
            easing: 'ease-out'
            });
            
            this.animation.onfinish = () => this.onAnimationFinish(true);
            
            this.animation.oncancel = () => this.isExpanding = false;
        }

        onAnimationFinish(open) {
            
            this.el.open = open;
            
            this.animation = null;
            
            this.isClosing = false;
            this.isExpanding = false;
            
            this.el.style.height = this.el.style.overflow = '';
        }
    }

    document.querySelectorAll('.toc details').forEach((el) => {
        new Accordion(el);
    });
</script>
<a href="#comment" aria-label="go to bottom comment" title="Go to Bottom Comment (Alt + B)" class="top-link bottom-comment" id="bottom-comment" accesskey="b" style="visibility: visible; opacity: 1;">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29.338 29.338" fill="currentcolor">
        <path d="M27.184,1.605H2.156C0.967,1.605,0,2.572,0,3.76v17.572c0,1.188,0.967,2.155,2.156,2.155h13.543
		l5.057,3.777c0.414,0.31,0.842,0.468,1.268,0.468c0.789,0,1.639-0.602,1.637-1.923v-2.322h3.523c1.188,0,2.154-0.967,2.154-2.155
		V3.76C29.338,2.572,28.371,1.605,27.184,1.605z M27.34,21.332c0,0.085-0.068,0.155-0.154,0.155h-5.523v3.955l-5.297-3.956H2.156
		c-0.086,0-0.154-0.07-0.154-0.155V3.759c0-0.085,0.068-0.155,0.154-0.155v0.001h25.029c0.086,0,0.154,0.07,0.154,0.155
		L27.34,21.332L27.34,21.332z M5.505,10.792h4.334v4.333H5.505C5.505,15.125,5.505,10.792,5.505,10.792z M12.505,10.792h4.334v4.333
		h-4.334V10.792z M19.505,10.792h4.334v4.333h-4.334V10.792z"/>
    </svg>
</a>

<script>
    let comment = document.getElementById("comment");
    let bottomToComment = document.getElementById("bottom-comment")
    
    document.addEventListener('scroll',function () {
        const viewPortHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight 
        const offsetTop = comment.offsetTop
        const scrollTop = document.documentElement.scrollTop
        const top = offsetTop - scrollTop
        if (top <= viewPortHeight + 100) {
            bottomToComment.style.visibility = "hidden";
            bottomToComment.style.opacity = "0";
        } else {
            bottomToComment.style.visibility = "visible";
            bottomToComment.style.opacity = "1";
        }
    })
</script><footer class="footer">
    <span>&copy; 2022 <a href="https://dyedbamboo.github.io/">染竹君的个人博客</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
    
</footer>

<script crossorigin="anonymous" src="/js/intersection-observer.min.c0ff09623e9f209a66c6130004e0422e1385fd8e8f8baaa14246a49c19827c68.js" integrity="sha256-wP8JYj6fIJpmxhMABOBCLhOF/Y6Pi6qhQkaknBmCfGg="></script>
<script crossorigin="anonymous" src="/js/lazyload.min.min.53e82bf9e8c145b953635b17fa3911ab6f3a8f1e4d37969aeb39d829d30fa6e9.js" integrity="sha256-U&#43;gr&#43;ejBRblTY1sX&#43;jkRq286jx5NN5aa6znYKdMPpuk="></script>


<script crossorigin="anonymous" src="/js/lightgallery.min.5d1410b8c831852c6c62b2dfad75f4e0f046a13e1826f97cd7a742523fab608c.js" integrity="sha256-XRQQuMgxhSxsYrLfrXX04PBGoT4YJvl816dCUj&#43;rYIw="></script>
<script crossorigin="anonymous" src="/js/lg-thumbnail.min.afa3995936244c14f68b85b13d657c368dc787cbcea863179950ac494dab6117.js" integrity="sha256-r6OZWTYkTBT2i4WxPWV8No3Hh8vOqGMXmVCsSU2rYRc="></script>
<script crossorigin="anonymous" src="/js/lg-zoom.min.a47b38d6f7138dce5f712f77780f339b5ec26af3bcd44950bcf736754ec88ed4.js" integrity="sha256-pHs41vcTjc5fcS93eA8zm17CavO81ElQvPc2dU7IjtQ="></script>
<script>
    const lazyLoadInstance = new LazyLoad({
        
    }); 
    
    const config = {
        selector: ".lightgallery",
        mode: "lg-slide",
        plugins: [lgZoom, lgThumbnail],
        speed: 400,
        hideBarsDelay: 2000,
        mousewheel: true,
        thumbnail: true,
        exThumbImage: "data-thumbnail",
        thumbWidth: 80,
        thumbContHeight: 80,
        mobileSettings: { controls: true, showCloseIcon: true, download: true, },
        licenseKey: "28AC9E09-3D8C45D8-8D6124E0-8FF74FF3", 
    };

    lightGallery(document.getElementsByClassName('post-content')[0], config);
</script>
<script>
    let details = document.getElementsByClassName('details')
    details = details || [];
    for (let i = 0; i < details.length; i++) {
        let element = details[i]
        const summary = element.getElementsByClassName('details-summary')[0];
        if (summary) {
            summary.addEventListener('click', () => {
                element.classList.toggle('open');
            }, false);
        }
    }
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
</script>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></body>

</html>